---
description:
---

import { Callout } from "nextra-theme-docs";

# IPFS migration guide

This guide covers how to migrate data on IPFS to Irys.

## Content IDs vs transaction IDs

IPFS and Irys take a different approach to identifying data, IPFS uses Content Identifiers (CIDs) and Irys uses transaction IDs.

-   IPFS Content Identifiers (CIDs) are generated by hashing the data being uploaded, the same data uploaded twice will generate the same CID.
-   Irys transaction IDs are generated by hashing the transaction signature, all transaction IDs are unique.

## Uploading with CIDs

While all uploads to Irys are assigned a transaction ID, it is also possible to manually assign a CID at upload and then use that CID to download your data.

### Uploading with a CID

To upload data to Irys using a CID, embed it as the value of the `IPFS-CID` tag when uploading data.

<Callout type="info" emoji="ℹ️">
	This code example generates a CID using the `ipfs-only-hash` package which uses the SHA-256 algorithm by default.
	IPFS also allows CIDs to be generated using SHA3 and Blake2, all of which are supported when uploading to Irys.
</Callout>

```js
import IPFS from "ipfs-only-hash";

const generateCID = async (content) => {
	return await IPFS.of(content);
};

const uploadToIrysWithCID = async () => {
	// See: https://docs.irys.xyz/developer-docs/irys-sdk#connecting-to-a-node
	const irys = await getIrys();

	const dataToUpload = "Irys + IPFS Content ID";
	const contentID = await generateCID(dataToUpload);
	console.log(`ContentID=${contentID}`);

	const tags = [
		{ name: "Content-Type", value: "text/html" },
		{ name: "IPFS-CID", value: contentID },
	];
	const receipt = await irys.upload(dataToUpload, { tags });

	// You can download using either the Irys transaction ID or IPFS Content ID
	console.log(`Transaction ID URL https://gateway.irys.xyz/${receipt.id}`);
	console.log(`Content ID URL https://gateway.irys.xyz/ipfs/${contentID}`);
};
```

### Downloading with a CID

To download data tagged with a CID, request it from the [Irys gateway](/overview/gateways) using an URL in the format `https://gateway.irys.xyz/ipfs/:contentID`.

<Callout type="info" emoji="ℹ️">
	If the same CID is assigned to more than one transaction, the Irys gateway will always return the one with the
	earliest timestamp.
</Callout>

```js
const fetchData = async (ipfsCID) => {
	const url = `https://gateway.irys.xyz/ipfs/${ipfsCID}`;
	console.log(`URL: ${url}`);

	const response = await fetch(url);
	const data = await response.text();
	console.log(`DATA: ${data}`);
};
```

## Migrating data from IPFS to Irys

You can migrate data from IPFS to Irys by first downloading the data from an IPFS gateway and then uploading it to an [Irys node](/overview/nodes). Users can choose to tag the uploads with the original IPFS CID and continue to retrieve data using the CID, or switch to using Irys transaction IDs.

This code example shows how to:

1. Download data from an IPFS gateway
2. Determine the data's content type (for example: `image/png`)
3. Re-upload the data to Irys while tagging it with the existing content type

<Callout type="info" emoji="ℹ️">
	Prior to uploading, users must fund an Irys node. Most users will choose to [up-front
	fund](/developer-docs/irys-sdk/api/fund#upfront-funding) where they pre-fund an Irys node with sufficient tokens to
	cover all data being migrated. Users can also choose to [lazy-fund](/developer-docs/irys-sdk/api/fund#lazy-funding)
	the uploads where you fund each separate upload.
</Callout>

```js
import fetch from "node-fetch";
import { fileTypeFromBuffer } from "file-type";
import Irys from "@irys/sdk";

const uploadToIrysWithCID = async (dataToUpload, contentType, contentID) => {
	// See: https://docs.irys.xyz/developer-docs/irys-sdk#connecting-to-a-node
	const irys = await getIrys();

	const tags = [
		{ name: "Content-Type", value: contentType },
		{ name: "IPFS-CID", value: contentID },
	];
	const receipt = await irys.upload(dataToUpload, { tags });
	console.log(`Direct URL: https://gateway.irys.xyz/${receipt.id}`);
	console.log(`Content ID URL: https://gateway.irys.xyz/ipfs/${contentID}`);
};

const downloadAndDetermineContentType = async (ipfsCID) => {
	try {
		const ipfsURL = `https://ipfs.io/ipfs/${ipfsCID}`;
		const response = await fetch(ipfsURL);
		const arrayBuffer = await response.arrayBuffer();
		const buffer = Buffer.from(arrayBuffer);

		const contentType = await fileTypeFromBuffer(buffer);

		if (contentType) {
			console.log(`Content Type: ${contentType.mime}`);
			await uploadToIrysWithCID(buffer, contentType.mime, ipfsCID);
		} else {
			console.error("Unable to determine content type");
		}
	} catch (error) {
		console.error("Error:", error);
	}
};

const ipfsCID = "QmUgL4YbnW9vMWZXLdAFzgxJwxpxJapZRLpjoT2ubU5WmF";
downloadAndDetermineContentType(ipfsCID);
```

## Common questions

### How can I learn more about the differences between IPFS and Irys?

In [this blog post](https://TODO.com).
(FYI: Connor / Josh: This blog post is still being edited, the URL will be updated once its done)

### How soon after uploading to Irys is my data available for use?

Our [optimistic cache](/learn/optimistic-cache) ensures all uploads are immediately available for download.

### How do I pay for uploads to Irys?

Irys accepts [most major tokens](/overview/supported-tokens) for payment. When migrating data, most users will choose to [up-front fund](/developer-docs/irys-sdk/api/fund#upfront-funding) where they pre-fund an Irys node with sufficient tokens to cover all data being migrated. Users can also choose to [lazy-fund](/developer-docs/irys-sdk/api/fund#lazy-funding) the uploads where you fund each separate upload.

### How much does it cost to upload data to Irys?

Irys charges a fee based on the number of bytes uploaded. You can calculate the exact cost using our [SDK](/developer-docs/irys-sdk/api/getPrice) or [fee calculator](/overview/cost-to-upload).

### Does Irys charge ongoing monthly fees to host my data?

No. Irys has a pay-once, store-forever model.

### How do I download data from Irys?

Using the [Irys gateway](/overview/gateways).

### Does the Irys gateway rate-limit my downloads?

No.

### Does Irys have a Devnet I can use while testing the migration?

Yes. On [our Devnet](/developer-docs/using-devnet) uploads are kept for ~60 days. You can pay for uploads using [free tokens available from faucets](/overview/supported-tokens#devnet-tokens).
